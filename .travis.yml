language: python
os: linux
dist: bionic

python:
  - 3.8

install:
  - pip install --upgrade -e .[dev]

script:
  - python setup.py clean --all
  - python setup.py bdist_wheel
  - flake8 ./unidown
  - pylint --rcfile=setup.cfg ./unidown/ || true
  - pyroma .
  - python setup.py check -v -m -s
  - twine check dist/*

deploy:
  - provider: script
    script: python setup.py sdist bdist_wheel && twine upload -u $PYPI_USER -p $PYPI_PASSWORD --skip-existing dist/*
    on:
      branch: master
      repo: IceflowRE/unidown-mr_de
      tags: true
